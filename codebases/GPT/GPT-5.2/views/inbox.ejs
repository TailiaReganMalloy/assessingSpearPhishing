<% layout('layout') -%>

<section class="panel">
  <div class="panel__header">
    <h1 class="panel__title">Inbox</h1>

    <div class="panel__actions">
      <a class="linkbtn" href="/compose">Compose</a>
      <form method="post" action="/logout">
        <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
        <button class="linkbtn" type="submit">Log out</button>
      </form>
    </div>
  </div>

  <div class="subline">Signed in as <strong><%= currentUser.email %></strong></div>

  <% if (!messages || messages.length === 0) { %>
    <div class="empty">No messages yet.</div>
  <% } else { %>
    <div class="table" role="table" aria-label="Inbox">
      <div class="table__row table__head" role="row">
        <div class="table__cell" role="columnheader">From</div>
        <div class="table__cell" role="columnheader">Subject</div>
        <div class="table__cell" role="columnheader">Received</div>
      </div>

      <% messages.forEach((m) => { %>
        <a class="table__row <%= m.read_at ? '' : 'is-unread' %>" role="row" href="/messages/<%= m.id %>">
          <div class="table__cell" role="cell"><%= m.sender_email %></div>
          <div class="table__cell" role="cell"><%= m.subject %></div>
          <div class="table__cell" role="cell"><%= m.created_at %></div>
        </a>
      <% }) %>
    </div>
  <% } %>
</section>
