<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BlueMind v5 - <%= view === 'inbox' ? 'Inbox' : 'Sent' %></title>
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body class="dashboard-page">
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-left">
      <div class="logo-small">
        <svg width="30" height="30" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M20 5 L35 15 L35 25 L20 35 L5 25 L5 15 Z" fill="#00A8E8"/>
          <circle cx="20" cy="20" r="8" fill="#003D7A"/>
          <path d="M20 12 L20 28 M12 20 L28 20" stroke="white" stroke-width="2"/>
        </svg>
      </div>
      <h1>BlueMind <span class="version-small">v5</span></h1>
    </div>
    <div class="header-right">
      <span class="user-email"><%= user.email %></span>
      <form action="/logout" method="POST" style="display: inline;">
        <button type="submit" class="btn-logout">Logout</button>
      </form>
    </div>
  </header>

  <!-- Main Content -->
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <nav class="sidebar-nav">
        <a href="/dashboard" class="nav-item <%= view === 'inbox' ? 'active' : '' %>">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M2 6L10 11L18 6M2 6V14C2 14.5304 2.21071 15.0391 2.58579 15.4142C2.96086 15.7893 3.46957 16 4 16H16C16.5304 16 17.0391 15.7893 17.4142 15.4142C17.7893 15.0391 18 14.5304 18 14V6M2 6C2 5.46957 2.21071 4.96086 2.58579 4.58579C2.96086 4.21071 3.46957 4 4 4H16C16.5304 4 17.0391 4.21071 17.4142 4.58579C17.7893 4.96086 18 5.46957 18 6Z" stroke="currentColor" stroke-width="1.5"/>
          </svg>
          Inbox
          <% if (view === 'inbox' && unreadCount > 0) { %>
            <span class="badge"><%= unreadCount %></span>
          <% } %>
        </a>
        <a href="/sent" class="nav-item <%= view === 'sent' ? 'active' : '' %>">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M2 3L9 10L2 17V3ZM2 3L18 10L2 3Z" stroke="currentColor" stroke-width="1.5"/>
          </svg>
          Sent
        </a>
        <a href="/compose" class="nav-item">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 5L14 3L17 6L15 8M12 5L5 12V15H8L15 8M12 5L15 8" stroke="currentColor" stroke-width="1.5"/>
          </svg>
          Compose
        </a>
      </nav>
    </aside>

    <!-- Message List -->
    <main class="content">
      <div class="content-header">
        <h2><%= view === 'inbox' ? 'Inbox' : 'Sent Messages' %></h2>
      </div>

      <div class="message-list">
        <% if (messages.length === 0) { %>
          <div class="empty-state">
            <p>No messages to display</p>
          </div>
        <% } else { %>
          <% messages.forEach(message => { %>
            <a href="/message/<%= message.id %>" class="message-item <%= message.read === 0 && view === 'inbox' ? 'unread' : '' %>">
              <div class="message-header">
                <span class="message-from">
                  <%= view === 'inbox' ? message.sender_email : message.recipient_email %>
                </span>
                <span class="message-date">
                  <%= new Date(message.sent_at).toLocaleDateString() %> 
                  <%= new Date(message.sent_at).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) %>
                </span>
              </div>
              <div class="message-subject"><%= message.subject %></div>
              <div class="message-preview"><%= message.body.substring(0, 100) %>...</div>
            </a>
          <% }) %>
        <% } %>
      </div>
    </main>
  </div>
</body>
</html>
