<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BlueMind Reference &mdash; Compose</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body class="app-shell">
  <header class="top-bar">
    <div class="top-bar-brand">
      <span class="logo">BlueMind</span>
      <span class="tag">v5</span>
    </div>
    <nav class="top-bar-nav">
      <a href="/inbox" class="nav-link">Inbox</a>
      <a href="/compose" class="nav-link active">Compose</a>
    </nav>
    <div class="top-bar-user">
      <span class="user-name"><%= currentUser %></span>
      <form method="post" action="/logout">
        <input type="hidden" name="_csrf" value="<%= csrfToken %>">
        <button type="submit" class="link-button">Logout</button>
      </form>
    </div>
  </header>

  <main class="compose-container">
    <h1>Compose Message</h1>

    <% if (error) { %>
      <div class="alert" role="alert"><%= error %></div>
    <% } %>

    <% if (success) { %>
      <div class="alert success" role="status"><%= success %></div>
    <% } %>

    <form method="post" action="/messages" class="compose-form">
      <input type="hidden" name="_csrf" value="<%= csrfToken %>">

      <label class="input-label" for="recipient">Recipient</label>
      <select id="recipient" name="recipientId" required>
        <option value="" disabled selected>Select a teammate</option>
        <% recipients.forEach((recipient) => { %>
          <option value="<%= recipient.id %>"><%= recipient.displayName %></option>
        <% }); %>
      </select>

      <label class="input-label" for="subject">Subject</label>
      <input id="subject" name="subject" type="text" maxlength="150" required>

      <label class="input-label" for="body">Message</label>
      <textarea id="body" name="body" rows="6" required></textarea>

      <div class="compose-actions">
        <a class="link-button" href="/inbox">Cancel</a>
        <button type="submit" class="primary-button">Send Message</button>
      </div>
    </form>
  </main>
</body>
</html>
