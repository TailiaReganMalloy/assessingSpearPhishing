<%- include('partials/header') %>

  <div class="card inbox">
    <h1>Inbox</h1>

    <% if (errors.length) { %>
      <ul class="errors">
        <% errors.forEach(e => { %>
          <li><%= e.msg %></li>
        <% }) %>
      </ul>
    <% } %>

    <section class="compose">
      <form action="/message" method="post">
        <input type="hidden" name="_csrf" value="<%= csrfToken %>">
        <label>To (email)</label>
        <input type="email" name="to" required />
        <label>Message</label>
        <textarea name="body" rows="4" required></textarea>
        <button class="btn">Send</button>
      </form>
    </section>

    <section class="messages">
      <h2>Messages</h2>
      <% if (!messages.length) { %>
        <p>No messages yet.</p>
      <% } %>

      <% messages.forEach(m => { %>
        <article class="message">
          <div class="meta">From: <strong><%= m.sender_email %></strong> â€” <small><%= m.created_at %></small></div>
          <div class="body"><%= m.body %></div>
        </article>
      <% }) %>
    </section>
  </div>

<%- include('partials/footer') %>